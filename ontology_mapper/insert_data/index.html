
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.5">
    
    
      
        <title>insert RDF data into Jena - PyFuseki</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.15aa0b43.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.75751829.min.css">
        
          
          
          <meta name="theme-color" content="#00bdd6">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="cyan" data-md-color-accent="">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sync-insert" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="PyFuseki" class="md-header-nav__button md-logo" aria-label="PyFuseki">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            PyFuseki
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              insert RDF data into Jena
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PyFuseki" class="md-nav__button md-logo" aria-label="PyFuseki">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    PyFuseki
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      


  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
      
      <label class="md-nav__link" for="nav-2">
        Fuseki Connection
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Fuseki Connection" data-md-level="1">
        <label class="md-nav__title" for="nav-2">
          <span class="md-nav__icon md-icon"></span>
          Fuseki Connection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../fuseki_connect/first_step/" class="md-nav__link">
        first step
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../fuseki_connect/sync_query/" class="md-nav__link">
        sync query
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../fuseki_connect/async_fuseki/" class="md-nav__link">
        async query
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      


  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
      
      <label class="md-nav__link" for="nav-3">
        Ontology Mapper
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Ontology Mapper" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          Ontology Mapper
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../define_entities/" class="md-nav__link">
        define your entity
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          insert RDF data into Jena
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        insert RDF data into Jena
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sync-insert" class="md-nav__link">
    Sync insert
  </a>
  
    <nav class="md-nav" aria-label="Sync insert">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-instantialize-fusekiupdate" class="md-nav__link">
    Step 1: Instantialize FusekiUpdate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-prepare-your-data" class="md-nav__link">
    Step 2: Prepare your data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-create-a-graph-object" class="md-nav__link">
    Step 3: Create a graph object
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-encapsulate-data" class="md-nav__link">
    Step 4: Encapsulate data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-insert-data-into-graph" class="md-nav__link">
    Step 5: Insert data into graph
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-insert-graph-into-jena" class="md-nav__link">
    Step 6: Insert graph into Jena
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view-the-results" class="md-nav__link">
    View the results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-complete-code" class="md-nav__link">
    The complete code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#async-insert" class="md-nav__link">
    Async insert
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sync-insert" class="md-nav__link">
    Sync insert
  </a>
  
    <nav class="md-nav" aria-label="Sync insert">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-instantialize-fusekiupdate" class="md-nav__link">
    Step 1: Instantialize FusekiUpdate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-prepare-your-data" class="md-nav__link">
    Step 2: Prepare your data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-create-a-graph-object" class="md-nav__link">
    Step 3: Create a graph object
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-encapsulate-data" class="md-nav__link">
    Step 4: Encapsulate data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-insert-data-into-graph" class="md-nav__link">
    Step 5: Insert data into graph
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-insert-graph-into-jena" class="md-nav__link">
    Step 6: Insert graph into Jena
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view-the-results" class="md-nav__link">
    View the results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-complete-code" class="md-nav__link">
    The complete code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#async-insert" class="md-nav__link">
    Async insert
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>insert RDF data into Jena</h1>
                
                <p>This section takes you step-by-step through converting the resulting data into RDF form and inserting it into Jena.</p>
<h2 id="sync-insert">Sync insert<a class="headerlink" href="#sync-insert" title="Permanent link">&para;</a></h2>
<h3 id="step-1-instantialize-fusekiupdate">Step 1: Instantialize <code>FusekiUpdate</code><a class="headerlink" href="#step-1-instantialize-fusekiupdate" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pyfuseki</span> <span class="kn">import</span> <span class="n">FusekiUpdate</span>

<span class="n">fuseki_update</span> <span class="o">=</span> <span class="n">FusekiUpdate</span><span class="p">(</span><span class="s1">&#39;localhost:3030&#39;</span><span class="p">,</span> <span class="s1">&#39;test_db&#39;</span><span class="p">)</span>
</code></pre></div>
<h3 id="step-2-prepare-your-data">Step 2: Prepare your data<a class="headerlink" href="#step-2-prepare-your-data" title="Permanent link">&para;</a></h3>
<p>Suppose we have the following data to insert when curling "Tencent" :</p>
<div class="highlight"><pre><span></span><code><span class="n">rev_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;band_project&#39;</span><span class="p">:</span> <span class="s1">&#39;腾讯&#39;</span><span class="p">,</span>
        <span class="s1">&#39;所属企业&#39;</span><span class="p">:</span> <span class="s1">&#39;深圳市腾讯计算机系统有限公司&#39;</span><span class="p">,</span>
        <span class="s1">&#39;成立日期&#39;</span><span class="p">:</span> <span class="s1">&#39;1998-11-11&#39;</span><span class="p">,</span>
        <span class="s1">&#39;英文名称&#39;</span><span class="p">:</span> <span class="s1">&#39;QQ&#39;</span>
    <span class="p">}</span>
</code></pre></div>
<h3 id="step-3-create-a-graph-object">Step 3: Create a graph object<a class="headerlink" href="#step-3-create-a-graph-object" title="Permanent link">&para;</a></h3>
<p>When you call the interface to insert the data, you need to use the <code>Graph</code> object from the <code>rdflib</code> library and store the data you want to insert into it. So we need to import the  <code>rdflib</code> library and create a 'Graph' object:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">rdflib</span> <span class="kn">import</span> <span class="n">Graph</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
</code></pre></div>
<h3 id="step-4-encapsulate-data">Step 4: Encapsulate data<a class="headerlink" href="#step-4-encapsulate-data" title="Permanent link">&para;</a></h3>
<p>Each data needs to be encapsulated in the form of RDF triples, and each type corresponds to the type of OWL ontology in order to realize the deduction of Jena inference machine.</p>
<p>The ontology mapper which be defined before will play an important role. </p>
<p>Here we use already written mappings and encapsulate the data as triples.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pyfuseki.ontology_mapper</span> <span class="kn">import</span> <span class="n">rdf_prefix</span><span class="p">,</span> <span class="n">BaseRdfPrefixEnum</span>
<span class="kn">from</span> <span class="nn">rdflib</span> <span class="kn">import</span> <span class="n">Namespace</span>
<span class="kn">from</span> <span class="nn">pyfuseki</span> <span class="kn">import</span> <span class="n">config</span>

<span class="nd">@rdf_prefix</span>
<span class="k">class</span> <span class="nc">RdfPrefix</span><span class="p">(</span><span class="n">BaseRdfPrefixEnum</span><span class="p">):</span>
    <span class="n">BrandProject</span> <span class="o">=</span> <span class="n">Namespace</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">COMMON_PREFIX</span> <span class="o">+</span> <span class="s1">&#39;BrandProject&#39;</span><span class="p">)</span>
    <span class="n">Firm</span> <span class="o">=</span> <span class="n">Namespace</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">COMMON_PREFIX</span> <span class="o">+</span> <span class="s1">&#39;Firm&#39;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">RdfPrefix</span>

<span class="n">tencent</span> <span class="o">=</span> <span class="n">RdfPrefix</span><span class="o">.</span><span class="n">BrandProject</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="s1">&#39;腾讯&#39;</span><span class="p">)</span>
</code></pre></div>
<p>Here, we encapsulate the brand project "Tencent" into <code>URIRef</code> form, that is, 'Tencent' variable is a <code>URIRef</code> type object.</p>
<p>By analogy with the above encapsulation method, we can encapsulate all previously owned data <code>rev_data</code> and put it into a <code>encap_data_dict</code> :</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">rdflib</span> <span class="kn">import</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">XSD</span>

<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">ObjectProperty</span> <span class="k">as</span> <span class="n">op</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="kn">import</span> <span class="n">DataProperty</span> <span class="k">as</span> <span class="n">dp</span>

<span class="n">encap_data_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">op</span><span class="o">.</span><span class="n">subordinateTo</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">FirmRdfPrefix</span><span class="o">.</span><span class="n">Firm</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="s1">&#39;深圳市腾讯计算机系统有限公司&#39;</span><span class="p">),</span>
        <span class="n">dp</span><span class="o">.</span><span class="n">createTime</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">Literal</span><span class="p">(</span><span class="n">rev_data</span><span class="p">[</span><span class="s1">&#39;成立日期&#39;</span><span class="p">],</span> <span class="n">datatype</span><span class="o">=</span><span class="n">XSD</span><span class="o">.</span><span class="n">date</span><span class="p">),</span>
        <span class="n">dp</span><span class="o">.</span><span class="n">enName</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">Literal</span><span class="p">(</span><span class="n">rev_data</span><span class="p">[</span><span class="s1">&#39;英文名称&#39;</span><span class="p">],</span> <span class="n">datatype</span><span class="o">=</span><span class="n">XSD</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
    <span class="p">}</span>
</code></pre></div>
<h3 id="step-5-insert-data-into-graph">Step 5: Insert data into graph<a class="headerlink" href="#step-5-insert-data-into-graph" title="Permanent link">&para;</a></h3>
<p>With the data encapsulated above, we are ready to transfer it into <code>graph</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pyfuseki</span> <span class="kn">import</span> <span class="n">RdfUtils</span>

<span class="n">RdfUtils</span><span class="o">.</span><span class="n">add_dict_to_graph</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">tencent</span><span class="p">,</span> <span class="n">encap_data_dict</span><span class="p">)</span>
</code></pre></div>
<p>In addition, you can use the <code>add_list_to_graph</code> function provided in <code>RDFUtils</code> or even the simpler <code>g.add()</code> method to insert data into the graph.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># add_list_to_graph() method</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>

<span class="n">tencent</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">BrandProject</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="s1">&#39;腾讯&#39;</span><span class="p">)</span>

<span class="n">spo_list</span> <span class="o">=</span><span class="p">[</span>
  <span class="p">(</span><span class="n">tencent</span><span class="p">,</span> <span class="n">URIRef</span><span class="p">(</span><span class="s1">&#39;http://www.ifa.com#hasName&#39;</span><span class="p">),</span> <span class="n">Literal</span><span class="p">(</span><span class="s1">&#39;腾讯&#39;</span><span class="p">,</span> <span class="n">datatype</span><span class="o">=</span><span class="n">XSD</span><span class="o">.</span><span class="n">string</span><span class="p">)),</span>
  <span class="p">(</span><span class="n">tencent</span><span class="p">,</span> <span class="n">URIRef</span><span class="p">(</span><span class="s1">&#39;http://www.ifa.com#hasApp&#39;</span><span class="p">),</span> <span class="n">URIRef</span><span class="p">(</span><span class="s1">&#39;http://www.ifa.com#App/wechat&#39;</span><span class="p">))</span>
<span class="p">]</span>

<span class="n">add_list_to_graph</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">spo_list</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># g.add() 插入方案</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>

<span class="n">tencent</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">BrandProject</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="s1">&#39;腾讯&#39;</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">tencent</span><span class="p">,</span> <span class="n">URIRef</span><span class="p">(</span><span class="s1">&#39;http://www.ifa.com#hasName&#39;</span><span class="p">),</span> <span class="n">Literal</span><span class="p">(</span><span class="s1">&#39;腾讯&#39;</span><span class="p">,</span><span class="n">datatype</span><span class="o">=</span><span class="n">XSD</span><span class="o">.</span><span class="n">string</span><span class="p">)))</span>
</code></pre></div>
<p>Select the most suitable data addition scheme according to the application scenario.</p>
<h3 id="step-6-insert-graph-into-jena">Step 6: Insert graph into Jena<a class="headerlink" href="#step-6-insert-graph-into-jena" title="Permanent link">&para;</a></h3>
<p>After you've finished transferring the encapsulated data into <code>graph</code>, you can insert the data into Jena Fuseki using <code>graph</code> as a staging point:</p>
<div class="highlight"><pre><span></span><code><span class="n">fusekiUpdate</span><span class="o">.</span><span class="n">insert_graph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</code></pre></div>
<h3 id="view-the-results">View the results<a class="headerlink" href="#view-the-results" title="Permanent link">&para;</a></h3>
<p>Open <code>localhost:3030</code> in a browser and execute the following SPARQL statement on the corresponding dataset page to see the insert result:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">WHERE</span> <span class="p">{</span> <span class="nv">?subject</span> <span class="nv">?predicate</span> <span class="nv">?object</span> <span class="p">};</span>
</code></pre></div>
<p>The insertion is successful if you can see the following result screen:</p>
<p><img alt="image-20210124223909364" src="../upload/image-20210124223909364.png" /></p>
<h3 id="the-complete-code">The complete code<a class="headerlink" href="#the-complete-code" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pyfuseki</span> <span class="kn">import</span> <span class="n">FusekiUpdate</span>
<span class="kn">import</span> <span class="nn">pyfuseki</span>
<span class="kn">from</span> <span class="nn">pyfuseki.utils</span> <span class="kn">import</span> <span class="n">RdfUtils</span>
<span class="kn">from</span> <span class="nn">rdflib</span> <span class="kn">import</span> <span class="n">Graph</span><span class="p">,</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">XSD</span>

<span class="kn">from</span> <span class="nn">demo.RdfPrefix</span> <span class="kn">import</span> <span class="n">RdfPrefix</span> <span class="k">as</span> <span class="n">rp</span>
<span class="kn">from</span> <span class="nn">demo.properties</span> <span class="kn">import</span> <span class="n">ObjectProperty</span> <span class="k">as</span> <span class="n">op</span><span class="p">,</span> <span class="n">DataProperty</span> <span class="k">as</span> <span class="n">dp</span>

<span class="n">pyfuseki</span><span class="o">.</span><span class="n">register</span><span class="o">.</span><span class="n">register_common_prefix</span><span class="p">(</span><span class="s2">&quot;http://www.yubin.com/kg/&quot;</span><span class="p">)</span>
<span class="n">fuseki</span> <span class="o">=</span> <span class="n">FusekiUpdate</span><span class="p">(</span><span class="s1">&#39;http://localhost:3030&#39;</span><span class="p">,</span> <span class="s1">&#39;pyfuseki_db&#39;</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>

<span class="c1"># RdfUtils.bind_prefixes_to_graph(self.g, [rp.BrandProject, rp.Firm])  # 绑定前缀</span>
<span class="c1"># 假设获取的数据为rev_data</span>
<span class="n">rev_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;band_project&#39;</span><span class="p">:</span> <span class="s1">&#39;腾讯&#39;</span><span class="p">,</span>
    <span class="s1">&#39;所属企业&#39;</span><span class="p">:</span> <span class="s1">&#39;深圳市腾讯计算机系统有限公司&#39;</span><span class="p">,</span>
    <span class="s1">&#39;成立日期&#39;</span><span class="p">:</span> <span class="s1">&#39;1998-11-11&#39;</span><span class="p">,</span>
    <span class="s1">&#39;英文名称&#39;</span><span class="p">:</span> <span class="s1">&#39;QQ&#39;</span>
<span class="p">}</span>
<span class="c1"># 将rev_data转化成RDF三元组并加入graph中</span>
<span class="n">tencent</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">BrandProject</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="s1">&#39;腾讯&#39;</span><span class="p">)</span>
<span class="n">RdfUtils</span><span class="o">.</span><span class="n">add_dict_to_graph</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">tencent</span><span class="p">,</span> <span class="p">{</span>
    <span class="n">op</span><span class="o">.</span><span class="n">subordinateTo</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">rp</span><span class="o">.</span><span class="n">Firm</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="s1">&#39;深圳市腾讯计算机系统有限公司&#39;</span><span class="p">),</span>
    <span class="n">dp</span><span class="o">.</span><span class="n">createTime</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">Literal</span><span class="p">(</span><span class="n">rev_data</span><span class="p">[</span><span class="s1">&#39;成立日期&#39;</span><span class="p">],</span> <span class="n">datatype</span><span class="o">=</span><span class="n">XSD</span><span class="o">.</span><span class="n">date</span><span class="p">),</span>
    <span class="n">dp</span><span class="o">.</span><span class="n">enName</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">Literal</span><span class="p">(</span><span class="n">rev_data</span><span class="p">[</span><span class="s1">&#39;英文名称&#39;</span><span class="p">],</span> <span class="n">datatype</span><span class="o">=</span><span class="n">XSD</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="c1"># 将graph插入</span>
<span class="n">fuseki</span><span class="o">.</span><span class="n">insert_graph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</code></pre></div>
<h2 id="async-insert">Async insert<a class="headerlink" href="#async-insert" title="Permanent link">&para;</a></h2>
<p>The overall process is similar to that of synchronous mode. All you need to do is replace <code>FusekiUpdate</code> with <code>AsyncFuseki</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pyfuseki</span> <span class="kn">import</span> <span class="n">AsyncFuseki</span>
<span class="kn">import</span> <span class="nn">pyfuseki</span>
<span class="kn">from</span> <span class="nn">pyfuseki.utils</span> <span class="kn">import</span> <span class="n">RdfUtils</span>
<span class="kn">from</span> <span class="nn">rdflib</span> <span class="kn">import</span> <span class="n">Graph</span><span class="p">,</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">XSD</span>
<span class="kn">from</span> <span class="nn">demo.RdfPrefix</span> <span class="kn">import</span> <span class="n">RdfPrefix</span> <span class="k">as</span> <span class="n">rp</span>
<span class="kn">from</span> <span class="nn">demo.properties</span> <span class="kn">import</span> <span class="n">ObjectProperty</span> <span class="k">as</span> <span class="n">op</span><span class="p">,</span> <span class="n">DataProperty</span> <span class="k">as</span> <span class="n">dp</span>
<span class="kn">import</span> <span class="nn">asyncio</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">insert_test</span><span class="p">():</span>
    <span class="n">pyfuseki</span><span class="o">.</span><span class="n">register</span><span class="o">.</span><span class="n">register_common_prefix</span><span class="p">(</span><span class="s2">&quot;http://www.yubin.com/kg/&quot;</span><span class="p">)</span>
    <span class="n">fuseki</span> <span class="o">=</span> <span class="n">AsyncFuseki</span><span class="p">(</span><span class="s1">&#39;http://localhost:3030&#39;</span><span class="p">,</span> <span class="s1">&#39;pyfuseki_db&#39;</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>

    <span class="c1"># RdfUtils.bind_prefixes_to_graph(self.g, [rp.BrandProject, rp.Firm])  # 绑定前缀</span>
    <span class="c1"># 假设获取的数据为rev_data</span>
    <span class="n">rev_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;band_project&#39;</span><span class="p">:</span> <span class="s1">&#39;腾讯&#39;</span><span class="p">,</span>
        <span class="s1">&#39;所属企业&#39;</span><span class="p">:</span> <span class="s1">&#39;深圳市腾讯计算机系统有限公司&#39;</span><span class="p">,</span>
        <span class="s1">&#39;成立日期&#39;</span><span class="p">:</span> <span class="s1">&#39;1998-11-11&#39;</span><span class="p">,</span>
        <span class="s1">&#39;英文名称&#39;</span><span class="p">:</span> <span class="s1">&#39;QQ&#39;</span>
    <span class="p">}</span>
    <span class="c1"># 将rev_data转化成RDF三元组并加入graph中</span>
    <span class="n">tencent</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">BrandProject</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="s1">&#39;腾讯&#39;</span><span class="p">)</span>
    <span class="n">RdfUtils</span><span class="o">.</span><span class="n">add_dict_to_graph</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">tencent</span><span class="p">,</span> <span class="p">{</span>
        <span class="n">op</span><span class="o">.</span><span class="n">subordinateTo</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">rp</span><span class="o">.</span><span class="n">Firm</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="s1">&#39;深圳市腾讯计算机系统有限公司&#39;</span><span class="p">),</span>
        <span class="n">dp</span><span class="o">.</span><span class="n">createTime</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">Literal</span><span class="p">(</span><span class="n">rev_data</span><span class="p">[</span><span class="s1">&#39;成立日期&#39;</span><span class="p">],</span> <span class="n">datatype</span><span class="o">=</span><span class="n">XSD</span><span class="o">.</span><span class="n">date</span><span class="p">),</span>
        <span class="n">dp</span><span class="o">.</span><span class="n">enName</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">Literal</span><span class="p">(</span><span class="n">rev_data</span><span class="p">[</span><span class="s1">&#39;英文名称&#39;</span><span class="p">],</span> <span class="n">datatype</span><span class="o">=</span><span class="n">XSD</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
    <span class="p">})</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="c1"># 将graph插入</span>
    <span class="k">await</span> <span class="n">fuseki</span><span class="o">.</span><span class="n">insert_graph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">insert_test</span><span class="p">())</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../define_entities/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                define your entity
              </div>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.93c04032.min.js"></script>
      <script src="../../assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>